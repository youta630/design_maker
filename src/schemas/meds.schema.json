{
    "$id": "https://example.com/meds.schema.json",
    "$schema": "http://json-schema.org/draft-07/schema#",
    "title": "Minimum Expressive Design System (MEDS) v1.1",
    "type": "object",
    "required": ["version", "modality", "viewportProfile", "foundations", "components", "composition"],
    "propertyOrdering": ["version", "modality", "source", "viewportProfile", "foundations", "components", "composition", "motionPatterns", "scene", "screenflow", "uxRulebook", "uxSignals", "unclear"],
    "properties": {
      "version": { "const": "1.1" },
      "modality": { "enum": ["image", "image-sequence", "style-image"] },
  
      "source": {
        "type": "object",
        "properties": {
          "fileName": { "type": "string" },
          "fileSize": { "type": "integer" },
          "frames": { "type": "integer" }
        },
        "additionalProperties": false
      },
  
      "viewportProfile": {
        "type": "object",
        "required": ["type", "widthPx", "confidence"],
        "properties": {
          "type": { "enum": ["mobile", "tablet", "desktop"] },
          "widthPx": { "$ref": "#/$defs/UnknownableInt" },
          "heightPx": { "$ref": "#/$defs/UnknownableInt" },
          "confidence": { "type": "number", "minimum": 0, "maximum": 1 }
        },
        "additionalProperties": false
      },
  
      "foundations": {
        "type": "object",
        "required": ["color", "typography", "spacing", "radius", "shadow", "motion", "grid", "a11y"],
        "propertyOrdering": ["color", "typography", "spacing", "radius", "shadow", "motion", "grid", "a11y"],
        "properties": {
          "color": {
            "type": "array",
            "minItems": 5,
            "items": {
              "type": "object",
              "required": ["token", "hex"],
              "properties": {
                "token": {
                  "enum": [
                    "bg", "surface", "border",
                    "text-primary", "text-secondary", "text-inverse",
                    "brand", "accent",
                    "error", "success", "warning",
                    "overlay"
                  ]
                },
                "hex": { "$ref": "#/$defs/ColorHexOrUnknown" },
                "usage": { "type": "string" }
              },
              "additionalProperties": false
            }
          },
  
          "typography": {
            "type": "object",
            "required": ["primaryFamily", "familyCandidates", "scalePx", "weights"],
            "properties": {
              "primaryFamily": { "type": "string" },
              "familyCandidates": {
                "type": "array",
                "minItems": 1,
                "items": {
                  "type": "object",
                  "required": ["family", "confidence"],
                  "properties": {
                    "family": { "type": "string" },
                    "confidence": { "type": "number", "minimum": 0, "maximum": 1 }
                  },
                  "additionalProperties": false
                }
              },
              "scalePx": {
                "type": "array",
                "minItems": 3,
                "items": { "type": "integer", "minimum": 8 }
              },
              "weights": {
                "type": "array",
                "minItems": 1,
                "items": { "type": "integer", "enum": [300, 400, 500, 600, 700, 800] }
              },
              "lineHeights": {
                "type": "array",
                "items": { "type": "number", "minimum": 1.0, "maximum": 2.0 }
              }
            },
            "additionalProperties": false
          },
  
          "spacing": {
            "type": "object",
            "required": ["basePx", "scalePx"],
            "properties": {
              "basePx": { "type": "integer", "minimum": 4, "default": 8 },
              "scalePx": {
                "type": "array",
                "minItems": 3,
                "items": { "type": "integer", "minimum": 4 },
                "default": [8,16,24]
              }
            },
            "additionalProperties": false
          },
  
          "radius": {
            "type": "array",
            "minItems": 1,
            "items": { "type": "integer", "minimum": 0 }
          },
  
          "shadow": {
            "oneOf": [
              {
                "type": "object",
                "properties": {
                  "none": { "type": "string" },
                  "sm": { "type": "string" },
                  "md": { "type": "string" },
                  "lg": { "type": "string" }
                },
                "additionalProperties": false,
                "default": { "none": "none" }
              },
              { "type": "null" }
            ]
          },
  
          "motion": {
            "type": "object",
            "required": ["durationsMs", "easings"],
            "properties": {
              "durationsMs": {
                "type": "object",
                "required": ["fast", "standard", "slow"],
                "properties": {
                  "fast": { "$ref": "#/$defs/UnknownableInt", "default": "unknown" },
                  "standard": { "$ref": "#/$defs/UnknownableInt", "default": "unknown" },
                  "slow": { "$ref": "#/$defs/UnknownableInt", "default": "unknown" }
                },
                "additionalProperties": false
              },
              "easings": {
                "type": "array",
                "minItems": 1,
                "items": { "$ref": "#/$defs/Easing" },
                "default": ["ease-in-out"]
              }
            },
            "additionalProperties": false
          },
  
          "grid": {
            "type": "object",
            "required": ["columns", "gapPx", "containerMaxWidthPx"],
            "properties": {
              "columns": { "type": "integer", "minimum": 1, "maximum": 24, "default": 12 },
              "gapPx": { "$ref": "#/$defs/UnknownableInt", "default": 16 },
              "containerMaxWidthPx": { "$ref": "#/$defs/UnknownableInt", "default": 1200 }
            },
            "additionalProperties": false
          },
  
          "a11y": {
            "type": "object",
            "required": ["hitAreaPx", "focusRing", "minContrast"],
            "properties": {
              "hitAreaPx": { "type": "integer", "minimum": 40, "default": 44 },
              "focusRing": {
                "type": "object",
                "required": ["widthPx", "colorToken"],
                "properties": {
                  "widthPx": { "type": "integer", "minimum": 1, "default": 2 },
                  "colorToken": { "type": "string", "default": "brand" }
                },
                "additionalProperties": false
              },
              "minContrast": { "enum": ["AA", "AAA"] }
            },
            "additionalProperties": false
          }
        },
        "additionalProperties": false
      },
  
      "components": {
        "type": "array",
        "minItems": 1,
        "items": {
          "type": "object",
          "required": ["type"],
          "properties": {
            "id": { "type": "string" },
            "type": { "$ref": "#/$defs/ComponentType" },
            "variants": {
              "type": "array",
              "items": {
                "type": "object",
                "required": ["name", "style"],
                "properties": {
                  "name": { "type": "string" },
                  "style": { "$ref": "#/$defs/ComponentStyle" }
                },
                "additionalProperties": false
              }
            },
            "states": {
              "type": "array",
              "items": {
                "type": "object",
                "required": ["name", "style"],
                "properties": {
                  "name": { "$ref": "#/$defs/ComponentState" },
                  "style": { "$ref": "#/$defs/ComponentStyle" }
                },
                "additionalProperties": false
              }
            },
            "style": { "$ref": "#/$defs/ComponentStyle" },
            "confidence": { "type": "number", "minimum": 0, "maximum": 1 }
          },
          "additionalProperties": false
        }
      },
  
      "motionPatterns": {
        "type": "object",
        "properties": {
          "micro": {
            "type": "array",
            "items": { "$ref": "#/$defs/MicroPattern" }
          },
          "macro": {
            "type": "array",
            "items": { "$ref": "#/$defs/MacroPattern" }
          }
        },
        "additionalProperties": false
      },
  
      "scene": {
        "type": "object",
        "properties": {
          "type": { "$ref": "#/$defs/SceneType" },
          "container": {
            "type": "object",
            "properties": {
              "heightVh": { "$ref": "#/$defs/UnknownableIntOrString" },
              "pinStart": { "type": ["string", "null"] },
              "pinEnd": { "type": ["string", "null"] }
            },
            "additionalProperties": false
          },
          "frames": {
            "type": "array",
            "items": { "type": "object", "properties": { "id": { "type": "string" } }, "required": ["id"], "additionalProperties": false }
          },
          "transitions": {
            "type": "array",
            "items": {
              "type": "object",
              "required": ["fromFrame", "toFrame", "steps"],
              "properties": {
                "fromFrame": { "type": "string" },
                "toFrame": { "type": "string" },
                "timeline": {
                  "type": "object",
                  "properties": {
                    "scrollRangeVh": { "$ref": "#/$defs/UnknownableInt" }
                  },
                  "additionalProperties": false
                },
                "steps": {
                  "type": "array",
                  "items": {
                    "type": "object",
                    "required": ["targetId", "property", "from", "to"],
                    "properties": {
                      "targetId": { "type": "string" },
                      "property": { "enum": ["opacity", "scale", "translateX", "translateY", "shadow", "color", "blur"] },
                      "from": { "type": "string" },
                      "to": { "type": "string" },
                      "durationPct": { "type": "number", "minimum": 0, "maximum": 100 },
                      "delayPct": { "type": "number", "minimum": 0, "maximum": 100 },
                      "easing": { "$ref": "#/$defs/Easing" },
                      "confidence": { "type": "number", "minimum": 0, "maximum": 1 }
                    },
                    "additionalProperties": false
                  }
                }
              },
              "additionalProperties": false
            }
          }
        },
        "additionalProperties": false
      },
  
      "composition": {
        "type": "object",
        "required": ["pagePaddingPx", "sectionGapPx", "cardInnerPaddingPx", "density"],
        "properties": {
          "pagePaddingPx": { "$ref": "#/$defs/UnknownableInt", "default": 16 },
          "sectionGapPx": { "$ref": "#/$defs/UnknownableInt", "default": 24 },
          "cardInnerPaddingPx": { "$ref": "#/$defs/UnknownableInt", "default": 16 },
          "density": { "enum": ["comfortable", "compact"], "default": "comfortable" }
        },
        "additionalProperties": false
      },
  
      "screenflow": {
        "type": "object",
        "properties": {
          "screens": {
            "type": "array",
            "items": { "type": "object", "required": ["id", "name"], "properties": {
              "id": { "type": "string" },
              "name": { "type": "string" },
              "components": { "type": "array", "items": { "type": "string" } }
            }, "additionalProperties": false }
          },
          "edges": {
            "type": "array",
            "items": { "type": "object", "required": ["from", "to", "trigger"], "properties": {
              "from": { "type": "string" },
              "to": { "type": "string" },
              "trigger": { "enum": ["click", "hover", "route", "scroll", "drag"] },
              "targetId": { "type": "string" }
            }, "additionalProperties": false }
          }
        },
        "additionalProperties": false
      },

      "uxRulebook": {
        "type": "object",
        "properties": {
          "version": { "type": "string", "const": "0.1" },
          "platform": { "enum": ["mobile","tablet","desktop"] },
          "rules": {
            "type": "array",
            "items": { "$ref": "#/$defs/UxRule" }
          },
          "defaults": {
            "type": "object",
            "properties": {
              "detailOpen": {
                "type": "object",
                "properties": {
                  "desktop": { "$ref": "#/$defs/UxAction" },
                  "mobile": { "$ref": "#/$defs/UxAction" }
                },
                "additionalProperties": false
              },
              "editOpen": {
                "type": "object",
                "properties": {
                  "desktop": { "$ref": "#/$defs/UxAction" },
                  "mobile": { "$ref": "#/$defs/UxAction" }
                },
                "additionalProperties": false
              },
              "settingsOpen": { "$ref": "#/$defs/UxAction" }
            },
            "additionalProperties": true
          }
        },
        "additionalProperties": false
      },

      "uxSignals": {
        "type": "object",
        "properties": {
          "platform": { "enum": ["mobile","tablet","desktop"] },
          "layout": {
            "type": "object",
            "properties": {
              "topNav": { "type": "boolean" },
              "sidebar": { "type": "boolean" },
              "density": { "enum": ["comfortable","compact","unknown"] }
            },
            "additionalProperties": false
          },
          "icons": { "type": "array", "items": { "enum": ["caret","ellipsis","chevron-right","help","external","download","plus"] } },
          "ctaLabels": { "type": "array", "items": { "type": "string" } }
        },
        "additionalProperties": false
      },

      "unclear": {
        "type": "array",
        "items": { "type": "string" }
      }
    },
  
    "$defs": {
      "UnknownableInt": {
        "oneOf": [
          { "type": "integer" },
          { "type": "string", "const": "unknown" }
        ]
      },
      "UnknownableIntOrString": {
        "oneOf": [
          { "type": "integer" },
          { "type": "string" }
        ]
      },
      "ColorHexOrUnknown": {
        "oneOf": [
          { "type": "string", "pattern": "^#([0-9A-Fa-f]{6}|[0-9A-Fa-f]{3})$" },
          { "type": "string", "const": "unknown" }
        ]
      },
      "Easing": {
        "oneOf": [
          { "type": "string", "enum": ["linear", "ease-in", "ease-out", "ease-in-out"] },
          { "type": "string", "pattern": "^cubic-bezier\\((-?\\d*\\.?\\d+\\s*,\\s*){3}-?\\d*\\.?\\d+\\)$" },
          { "type": "string", "const": "unknown" }
        ]
      },
      "ComponentType": {
        "type": "string",
        "enum": [
          "AppBar","TopNav","Sidebar","Drawer","Tabs","Button","IconButton","TextField","TextArea","Select","Checkbox","RadioGroup","Switch","Card","ListItem","Table","Badge","Avatar","Modal","Dialog","Alert"
        ]
      },
      "ComponentState": {
        "type": "string",
        "enum": ["default","hover","active","focus","disabled","loading","error","success","selected","pressed"]
      },
      "ComponentStyle": {
        "type": "object",
        "properties": {
          "colors": {
            "type": "object",
            "properties": {
              "bg": { "type": "string" },
              "text": { "type": "string" },
              "border": { "type": "string" },
              "accent": { "type": "string" }
            },
            "additionalProperties": false
          },
          "typography": {
            "type": "object",
            "properties": {
              "sizePx": { "$ref": "#/$defs/UnknownableInt" },
              "weight": { "type": "integer" },
              "lineHeight": { "type": "number" }
            },
            "additionalProperties": false
          },
          "spacing": {
            "type": "object",
            "properties": {
              "paddingPx": { "$ref": "#/$defs/UnknownableInt" },
              "gapPx": { "$ref": "#/$defs/UnknownableInt" }
            },
            "additionalProperties": false
          },
          "radiusPx": { "$ref": "#/$defs/UnknownableInt" },
          "shadowToken": { "type": "string", "enum": ["none","sm","md","lg"] },
          "icon": {
            "type": "object",
            "properties": {
              "sizePx": { "$ref": "#/$defs/UnknownableInt" },
              "gapPx": { "$ref": "#/$defs/UnknownableInt" }
            },
            "additionalProperties": false
          },
          "effects": {
            "type": "object",
            "properties": {
              "opacity": { "type": "number", "minimum": 0, "maximum": 1 },
              "scale": { "type": "number", "minimum": 0.5, "maximum": 2.0 },
              "translateX": { "type": "string" },
              "translateY": { "type": "string" }
            },
            "additionalProperties": false
          }
        },
        "additionalProperties": false
      },
      "MicroPattern": {
        "type": "string",
        "enum": [
          "hover-lift","press-compress","focus-ring","tooltip-fade-in","skeleton-shimmer"
        ]
      },
      "MacroPattern": {
        "type": "string",
        "enum": [
          "modal-open","drawer-slide","dropdown-pop","tab-switch","toast-enter","accordion-expand","route-fade","list-reorder"
        ]
      },
      "SceneType": {
        "type": "string",
        "enum": ["sticky-pin","free-scroll","parallax","tab-switch","modal-open","accordion"]
      },
      "UxFamily": {
        "type": "string",
        "enum": [
          "Navigation","Details","Edit","Menus","Confirm","Feedback","Target","Motion"
        ]
      },
      "UxEvent": {
        "type": "string",
        "enum": ["click","hover","focus","submit"]
      },
      "UxAction": {
        "type": "string",
        "enum": [
          "route","modal","sheet","drawer","dropdown","menu","popover","inline","external","download","toast","banner"
        ]
      },
      "UxSelector": {
        "type": "object",
        "properties": {
          "location": { "enum": ["TopNav","Sidebar","Content","Card","Footer","Hero","TableRow","ListItem"] },
          "labelIncludes": { "type": "array", "items": { "type": "string" } },
          "icon": { "enum": ["caret","ellipsis","chevron-right","help","external","download","plus"] }
        },
        "additionalProperties": false
      },
      "UxRule": {
        "type": "object",
        "required": ["id","family","event","action","priority"],
        "properties": {
          "id": { "type": "string" },
          "family": { "$ref": "#/$defs/UxFamily" },
          "event": { "$ref": "#/$defs/UxEvent" },
          "selector": { "$ref": "#/$defs/UxSelector" },
          "conditions": { "type": "array", "items": { "type": "string" } },
          "action": { "$ref": "#/$defs/UxAction" },
          "alternatives": { "type": "array", "items": { "$ref": "#/$defs/UxAction" } },
          "destination": { "type": "object", "properties": { "screen": { "type": "string" } }, "additionalProperties": false },
          "priority": { "enum": ["high","medium","low"] },
          "confidence": { "type": "number", "minimum": 0, "maximum": 1 },
          "origin": { "enum": ["global-default","image-heuristic"] },
          "rationale": { "type": "array", "items": { "type": "string" } }
        },
        "additionalProperties": false
      }
    },
  
    "additionalProperties": false
  }